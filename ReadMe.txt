Отток клиентов
Из «Бета-Банка» стали уходить клиенты. Каждый месяц. Немного, но заметно. Банковские маркетологи посчитали: сохранять текущих клиентов дешевле, чем привлекать новых.

Нужно спрогнозировать, уйдёт клиент из банка в ближайшее время или нет. Вам предоставлены исторические данные о поведении клиентов и расторжении договоров с банком.

Постройте модель с предельно большим значением F1-меры. Чтобы сдать проект успешно, нужно довести метрику до 0.59. Проверьте F1-меру на тестовой выборке самостоятельно.

Дополнительно измеряйте AUC-ROC, сравнивайте её значение с F1-мерой.

Источник данных: https://www.kaggle.com/barelydedicated/bank-customer-churn-modeling

В работе был использован датасет с данными клиентов «Бета-Банка».
Описание данных
Данные находятся в файле /datasets/Churn.csv (англ. «отток клиентов»)
Признаки
•	RowNumber — индекс строки в данных
•	CustomerId — уникальный идентификатор клиента
•	Surname — фамилия
•	CreditScore — кредитный рейтинг
•	Geography — страна проживания
•	Gender — пол
•	Age — возраст
•	Tenure — сколько лет человек является клиентом банка
•	Balance — баланс на счёте
•	NumOfProducts — количество продуктов банка, используемых клиентом
•	HasCrCard — наличие кредитной карты
•	IsActiveMember — активность клиента
•	EstimatedSalary — предполагаемая зарплата
Целевой признак
•	Exited — факт ухода клиента

Была проведена предподготовка данных:

проверка на пропуски и корректность формата данных
пропущенные значения были заполнены экстремальными значениями
была произведена оптимизация датафрейма для машинного обучения: убрали столбцы, которые не представляют ценности для обучения модели
оставшиеся данные подготовлены методом One_hot_encoding.
Определены следующие модели для обучения: логистическая регрессия, дерево решений и случайный лес.

В первоначальных данных наблюдался значительный дисбаланс (80% ответов целевого признака были негативными и только 20% позитивными).
Все модели на первоначальных данных характеризуются низким качеством взвешенной величины (F1-мера), модели показывали низкие результаты точности и полноты.

Устранили дисбаланс классов в обучающей выборке. Сравнили показатели метрик при балансировки классов, а также методами downsampling и upsampling.
Метод upsampling оказался эффективнее метода downsampling. Это подтверждается значениями метрик для каждой модели:

Логистическая регрессия (выборка методом downsampling)
Качество модели 0.725
Точность модели 0.4053
Полнота 0.7451
F1-мера 0.525
AUC-ROC 0.7325

Логистическая регрессия (выборка методом upsampling)
Качество модели 0.7255
Точность модели 0.4056
Полнота 0.7426
F1-мера 0.5247
AUC-ROC 0.7319

Дерево решений (выборка методом downsampling)
Качество модели 0.786
Точность модели 0.4845
Полнота 0.7672
F1-мера 0.5939
AUC-ROC 0.779

Дерево решений (выборка методом upsampling)
Качество модели 0.771
Точность модели 0.4628
Полнота 0.7623
F1-мера 0.5759
AUC-ROC 0.7677

Случайный лес (выборка методом downsampling)
Качество модели 0.807
Точность модели 0.5172
Полнота 0.8088
F1-мера 0.631
AUC-ROC 0.8077

Случайный лес (выборка методом upsampling)
Качество модели 0.8465
Точность модели 0.6086
Полнота 0.6936
F1-мера 0.6483
AUC-ROC 0.7897

На новых данных все модели показали результат выше, чем на несбалансированной выборке. Лучшие показатели были у модели Случайного леса обученной на выборке сбалансированной методом Upsampling
Было принято решение произвести тестирование на этой модели.

Финальная модель прошла проверку на адекватность в сравнении с константной моделью:
Качество константной модели 0.796
Качество тестовой модели: 0.8465
AUC-ROC константой модели: 0.5
AUC-ROC тестовой модели: 0.7897

Финальная модель достигла заданной метрики (показатели метрики F1-мера достигли значения не менее 0.59):
Качество 0.826
Точность 0.5657
Полнота 0.6241
F1-мера 0.5935
AUC-ROC 0.8508

Модель характеризуется высоким показателем полноты 0.6241 , поэтому она с высокой вероятностью предскажет уход клиента из банка. Показатель точности не высокий = 0.5657, модель верно предсказывает только половину ухода клиентов.